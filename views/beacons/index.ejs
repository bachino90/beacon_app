<% include layout %>
<body>

<!-- Modal Show Beacon -->
<div class="modal fade" id="showBeacon" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Show Beacon</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">UUID</h3>
          </div>
          <div class="panel-body" id='show_beacon_uuid'>-</div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Major ID</h3>
          </div>
          <div class="panel-body" id='show_beacon_major_id'>-</div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Minor ID</h3>
          </div>
          <div class="panel-body" id='show_beacon_minor_id'>-</div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Content</h3>
          </div>
          <div class="panel-body" id='show_beacon_content'>-</div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-info" data-dismiss="modal" id="updateBeacon">Update</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Add New Beacon -->
<div class="modal fade" id="newBeaconModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Add New Beacon</h4>
      </div>
      <form id="newBeaconForm" action="/beacons" method="post">
        <div class="modal-body">
          <!-- show any messages that come back with authentication -->
          <% if (message.length > 0) { %>
            <div class="alert alert-danger"><%= message %></div>
          <% } %>
          <% for(var error in valErr['errors']) { %>
            <div class="alert alert-danger"><%= valErr['errors'][error].message %></div>
          <% } %>
          <div class="input-group" id='uuid' style="margin-bottom:20px">
            <span class="input-group-addon">UUID  </span>
            <input type="text" class="form-control" placeholder="12312312312-1231-2312-3123-123123123123" name="uuid" pattern="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$" required>
          </div>
          <div class="input-group" id='minor_id' style="margin-bottom:20px">
            <span class="input-group-addon">Minor ID</span>
            <input type="number" class="form-control" placeholder="1" name="minor_id">
          </div>
          <div class="input-group" id='major_id' style="margin-bottom:20px">
            <span class="input-group-addon">Major ID</span>
            <input type="number" class="form-control" placeholder="2" name="major_id">
          </div>
          <div class="input-group" id='content' style="margin-bottom:0px">
            <span class="input-group-addon">Content</span>
            <textarea class="form-control" rows="3" name="content"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <input type="submit" class="btn btn-primary" value="Add" id='addNewBeaconButton' disabled/>
        </div>
      </form>
    </div>
  </div>
</div>

<% if (routeNew == true) { %>
  <script>
    $('#newBeaconModal').modal();
  </script>
<% } %>

<!-- Modal Update New Beacon -->
<div class="modal fade" id="updateBeaconModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Update Beacon</h4>
      </div>
      <form id="updateBeaconForm" action="/beacons" method="post">
        <input name="_method" value="PUT" type="hidden">
        <div class="modal-body">
          <!-- show any messages that come back with authentication -->

          <div class="input-group" id='uuid_update' style="margin-bottom:20px">
            <span class="input-group-addon">UUID  </span>
            <input type="text" class="form-control" placeholder="12312312312-1231-2312-3123-123123123123" name="uuid" pattern="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$" required>
          </div>
          <div class="input-group" id='minor_id_update' style="margin-bottom:20px">
            <span class="input-group-addon">Minor ID</span>
            <input type="number" class="form-control" placeholder="1" name="minor_id">
          </div>
          <div class="input-group" id='major_id_update' style="margin-bottom:20px">
            <span class="input-group-addon">Major ID</span>
            <input type="number" class="form-control" placeholder="2" name="major_id">
          </div>
          <div class="input-group" id='content_update' style="margin-bottom:0px">
            <span class="input-group-addon">Content</span>
            <textarea class="form-control" rows="3" name="content"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <input type="submit" class="btn btn-primary" value="Update" id='updateBeaconButton'/>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Table -->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Panel de Control</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="function(){}" data-toggle="modal" data-target="#newBeaconModal">Add New Beacon</a></li>
        <li><a href="logout">Logout</a></li>
      </ul>
    </div>
  </div>
</div>
<div class="container-fluid">
  <div class="row">
    <div class="col-sm-3 col-md-2 sidebar">
      <ul class="nav nav-sidebar">
        <li class="active"><a href="#">Home</a></li>
      </ul>
    </div>
    <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
      <h1 class="page-header">Beacons <small>(<%= beacons.length %>)</small></h1>
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead><tr><th>UUID</th><th>Major ID</th><th>Minor ID</th><th>Content</th><th>Borrar</th></tr></thead>
          <tbody>
            <% for(var i=0; i<beacons.length; i++) { %>
             <tr class='clickableRow' id=<%= beacons[i]._id %>>
               <td><%= beacons[i].uuid %></td>
               <td><%= beacons[i].major_id %></td>
               <td><%= beacons[i].minor_id %></td>
               <td><%= beacons[i].content %></td>
               <!-- Button trigger modal
               <td><button class="btn btn-primary" data-toggle="modal" data-target="#myModal">
                  Update
                </button>
               </td>
               -->
               <td>
                 <form action='beacons/<%= beacons[i]._id %>' method='POST'>
                   <input name="_method" value="DELETE" type="hidden">
                   <input type="submit" class="btn btn-danger" value="Borrar" />
                 </form>
               </td>
             </tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

</body>
</html>
